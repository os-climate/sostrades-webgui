<div *ngIf="hasDashboard; else missingDashboardMessage" style="height: 100%;">
  <div class="flex-container">
    <div
      *ngIf="loadedStudy.dashboard['title']"
      style="width : 100%"
    >
      <div class="widget-container">
        <div class="widget-cell">
          <div class="h2" style="font-weight: bold; text-align: center;">
            {{loadedStudy.dashboard['title']}}
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="loadedStudy.dashboard['rows']">
      <div

        *ngFor="let row of loadedStudy.dashboard['rows']"
      >
        <div class="widget-container">
          <div
            *ngFor="let block of row"
          >
            <div class="widget-cell">
              <div *ngIf="block['content_type'] === 'TEXT'" [className]="block['style'] ? block['style'] : ''">
                {{block['content']}}
              </div>
              <div *ngIf="block['content_type'] === 'SCALAR'">
                <strong>{{block['content']['var_name']}} :</strong>
                {{block['content']['value']}}
              </div>
              <div *ngIf="block['content_type'] === 'POST_PROCESSING'" class="plot-resize-zone">
                <app-post-processing-plotly
                  *ngFor="let plot of [block['content']]"
                  [class]="
                    plot['data'] && plot['data'][0] && plot['data'][0]['type'] === 'table'
                      ? 'table'
                      : 'plot'
                  "
                  [plotData]="plot"
                  [fullNamespace]=""
                  [plotIndex]="0"
                  [disciplineName]=""
                  [name]=""
                >
                </app-post-processing-plotly>

              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #missingDashboardMessage>
  <div class="edit-save-button">
    <button
      id="edit-dashboard"
      matTooltip="Edit dashboard"
      mat-raised-button
      color="primary"
      class="float-right-button"
      (click)="handleEditButtonClick(slideToggle)"
    >
      <mat-slide-toggle #slideToggle [checked]="options.draggable.enabled" (change)="onSlideToggleChange($event)">
      </mat-slide-toggle>
      Edit
    </button>
    <button
      id="reorder-dashboard"
      matTooltip="Reorder dashboard"
      mat-raised-button
      color="primary"
      class="float-right-button"
      (click)="onReorder()"
    >
     <i class="fa-solid fa-rotate-right"></i>
      Reorder
    </button>
    <button
      id="save-dashboard"
      *ngIf="isDashboardUpdated"
      matTooltip="Update saved dashboard"
      mat-raised-button
      color="primary"
      class="float-right-button"
      (click)="OnSaveDashboard()"
    >
      <i class="fa-solid fa-floppy-disk"></i>
      Save
    </button>
  </div>
  <div
    *ngIf="dashboardFavorites.length > 0"
    class="plot-resize-zone"
  >
    <div class="gridster-container">
      <gridster [options]="options">
        <gridster-item *ngFor="let item of graphItems" [item]="item">
          <div class="graph-card">
            <app-post-processing-plotly
              [class]="item.data && item.data.graphData && item.data.graphData[0]?.type === 'table' ? 'table' : 'plot'"
              [fullNamespace]=""
              [plotData]="item.data.graphData"
              [disciplineName]="item.disciplineName"
              [name]="item.name"
              [plotIndex]="item.plotIndex"
              [height]="getGraphHeight(item)"
              [width]="getGraphWidth(item)">
            </app-post-processing-plotly>
          </div>
        </gridster-item>
      </gridster>
    </div>
<!--    <app-post-processing-plotly-->
<!--      *ngFor="let plot of graphItems"-->
<!--      [class]="plot.data && plot.data.graphData && plot.data.graphData[0]?.type === 'table' ? 'table' : 'plot'"-->
<!--      [fullNamespace]=""-->
<!--      [plotData]="plot.data.graphData"-->
<!--      [disciplineName]="plot.disciplineName"-->
<!--      [name]="plot.name"-->
<!--      [plotIndex]="plot.plotIndex">-->
<!--    </app-post-processing-plotly>-->
  </div>
</ng-template>
